#!/bin/zsh

upowerdump=$(upower -d)
batrate="$(echo ${upowerdump} | grep energy-rate | awk '{print $2}')"

if [[ ${batrate} -gt 7 ]]; then
    if [[ ${batrate} -gt 12 ]]; then
        color="#cc0000" # 12+ red
    else
        color="#89bdff" # 7-12 blue
    fi
else
    color="#73d216" # <7 green
fi

if [[ $(echo ${upowerdump} | grep state | awk '{print $2}' | head -n 1) == "charging" ]]; then
    prefix="<fc=#73d216>+</fc>"
    color="#73d216" # <7 green
else
    prefix="<fc=#cc0000>-</fc>"
fi

batrate="$(printf '%.2f' ${batrate} | sed 's/\,/\./g')"

echo "${prefix}<fc=${color}>${batrate}</fc>"
